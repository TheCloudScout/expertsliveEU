{
  "variables": {
    "workspaceResourceId": "[resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspaceName'))]"
  },
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "outputs": {
    "ResourceId": {
      "type": "string",
      "value": "[resourceId('Microsoft.Insights/dataCollectionRules', parameters('dcrName'))]"
    }
  },
  "resources": [
    {
      "location": "[resourceGroup().location]",
      "properties": {
        "destinations": {
          "logAnalytics": [
            {
              "workspaceResourceId": "[variables('workspaceResourceId')]",
              "name": "[parameters('workspaceName')]"
            }
          ]
        },
        "dataFlows": [
          {
            "destinations": [
              "[parameters('workspaceName')]"
            ],
            "transformKql": "source\n| project-away ConditionalAccessPolicies\n",
            "streams": [
              "Microsoft-Table-AADNonInteractiveUserSignInLogs"
            ]
          },
          {
            "destinations": [
              "[parameters('workspaceName')]"
            ],
            "outputStream": "Custom-AADNonInteractiveUserSignInLogs_CL",
            "streams": [
              "Microsoft-Table-AADNonInteractiveUserSignInLogs"
            ],
            "transformKql": "source\n"
          },
          {
            "destinations": [
              "[parameters('workspaceName')]"
            ],
            "transformKql": "source\n| where OperationName == 'DeleteFile' or \n        OperationName == 'Flush' or \n        Category == 'StorageDelete'\n",
            "streams": [
              "Microsoft-Table-StorageBlobLogs"
            ]
          },
          {
            "destinations": [
              "[parameters('workspaceName')]"
            ],
            "outputStream": "Custom-StorageBlobLogs_CL",
            "streams": [
              "Microsoft-Table-StorageBlobLogs"
            ],
            "transformKql": "source\n"
          }
        ],
        "dataSources": {}
      },
      "name": "[parameters('dcrName')]",
      "type": "Microsoft.Insights/dataCollectionRules",
      "dependsOn": [
        "[concat(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspaceName')), '/tables/AADNonInteractiveUserSignInLogs_CL')]",
        "[concat(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspaceName')), '/tables/StorageBlobLogs_CL')]"
      ],
      "kind": "WorkspaceTransforms",
      "apiVersion": "2022-06-01"
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/tables",
      "apiVersion": "2022-10-01",
      "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspaceName')), '/tables/AADNonInteractiveUserSignInLogs')]",
      "properties": {
        "plan": "Analytics",
        "retentionInDays": 30
      },
      "name": "[concat(parameters('workspaceName'), '/AADNonInteractiveUserSignInLogs')]"
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/tables",
      "apiVersion": "2021-12-01-preview",
      "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspaceName')), '/tables/AADNonInteractiveUserSignInLogs_CL')]",
      "properties": {
        "schema": {
          "name": "AADNonInteractiveUserSignInLogs_CL",
          "columns": [
            {
              "name": "SourceSystem",
              "type": "string",
              "displayName": "SourceSystem",
              "description": "Details of source system of the object being provisioned.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "TimeGenerated",
              "type": "datetime",
              "displayName": "TimeGenerated",
              "description": "The date and time of the event in UTC.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "OperationName",
              "type": "string",
              "displayName": "OperationName",
              "description": "For sign-ins, this value is always Sign-in activity.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "OperationVersion",
              "type": "string",
              "displayName": "OperationVersion",
              "description": "The REST API version that's requested by the client.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "Category",
              "type": "string",
              "displayName": "Category",
              "description": "Category of the sign-in event.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "ResultType",
              "type": "string",
              "displayName": "ResultType",
              "description": "The result of the sign-in operation can be Success or Failure.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "ResultSignature",
              "type": "string",
              "displayName": "ResultSignature",
              "description": "Contains the error code, if any, for the sign-in operation.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "ResultDescription",
              "type": "string",
              "displayName": "ResultDescription",
              "description": "Provides the error description for the sign-in operation.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "DurationMs",
              "type": "long",
              "displayName": "DurationMs",
              "description": "The duration of the operation in milliseconds.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "CorrelationId",
              "type": "string",
              "displayName": "CorrelationId",
              "description": "ID to provide sign-in trail.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "ResourceGroup",
              "type": "string",
              "displayName": "ResourceGroup",
              "description": "Resource group for the logs.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "Identity",
              "type": "string",
              "displayName": "Identity",
              "description": "The identity from the token that was presented when you made the request. It can be a user account, system account, or service principal.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "Level",
              "type": "string",
              "displayName": "Level",
              "description": "The severity level of the event.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "Location",
              "type": "string",
              "displayName": "Location",
              "description": "The region of the resource emitting the event.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "AlternateSignInName",
              "type": "string",
              "displayName": "AlternateSignInName",
              "description": "Provides the on-premises UPN of the user sign-ing into Azure AD.e.g. Phone number sign-in.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "AppDisplayName",
              "type": "string",
              "displayName": "AppDisplayName",
              "description": "App name displayed in the Azure portal.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "AppId",
              "type": "string",
              "displayName": "AppId",
              "description": "Unique GUID representing the app ID in the Azure Active Directory.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "AppliedEventListeners",
              "type": "dynamic",
              "displayName": "AppliedEventListeners",
              "description": "Detailed information about the applied event listeners or listeners that are triggered by the corresponding events in an authentication activity. It's called appliedEventListeners in ALP and MSGraph, but use Authentication Events to match name on UX.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "AuthenticationContextClassReferences",
              "type": "string",
              "displayName": "AuthenticationContextClassReferences",
              "description": "The authentication contexts of the sign-in.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "AuthenticationDetails",
              "type": "string",
              "displayName": "AuthenticationDetails",
              "description": "A record of each step of authentication undertaken in the sign-in.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "AuthenticationMethodsUsed",
              "type": "string",
              "displayName": "AuthenticationMethodsUsed",
              "description": "List of authentication methods used.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "AuthenticationProcessingDetails",
              "type": "string",
              "displayName": "AuthenticationProcessingDetails",
              "description": "Provides the details associated with authentication processor.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "AuthenticationProtocol",
              "type": "string",
              "displayName": "AuthenticationProtocol",
              "description": "Lists the protocol type or grant type used in the authentication. The possible values are: none, oAuth2, ropc, wsFederation, saml20, deviceCode, unknownFutureValue. For authentications that use protocols other than the possible values listed, the protocol type is listed as none.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "AuthenticationRequirement",
              "type": "string",
              "displayName": "AuthenticationRequirement",
              "description": "Type of authentication required for the sign-in.  If set to multiFactorAuthentication, an MFA step was required.  If set to singleFactorAuthentication, no MFA was required.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "AuthenticationRequirementPolicies",
              "type": "string",
              "displayName": "AuthenticationRequirementPolicies",
              "description": "Set of CA policies that apply to this sign-in, each as CA: policy name, and/or MFA: Per-user.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "AutonomousSystemNumber",
              "type": "string",
              "displayName": "AutonomousSystemNumber",
              "description": "Autonomous System Number for the network.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "ClientAppUsed",
              "type": "string",
              "displayName": "ClientAppUsed",
              "description": "Details outlining app auth used (Legacy vs non Legacy) Eg: Modern Browser, Native App, Exchange Activty Sync and Older Clients.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "ConditionalAccessPolicies",
              "type": "string",
              "displayName": "ConditionalAccessPolicies",
              "description": "Details of the conditional access policies being applied for the sign-in.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "ConditionalAccessPoliciesV2",
              "type": "dynamic",
              "displayName": "ConditionalAccessPoliciesV2",
              "description": "[Deprecated. Use ConditionalAccessPolicies instead]. Details of the conditional access policies being applied for the sign-in.",
              "isDefaultDisplay": true,
              "isHidden": true
            },
            {
              "name": "ConditionalAccessStatus",
              "type": "string",
              "displayName": "ConditionalAccessStatus",
              "description": "Status of all the conditionalAccess policies related to the sign-in.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "CreatedDateTime",
              "type": "datetime",
              "displayName": "CreatedDateTime",
              "description": "Datetime of the sign-in activity.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "CrossTenantAccessType",
              "type": "string",
              "displayName": "CrossTenantAccessType",
              "description": "Describes the type of cross-tenant access used by the actor to access the resource. Possible values are: none, b2bCollaboration, b2bDirectConnect, microsoftSupport, serviceProvider, unknownFutureValue. If the sign in did not cross tenant boundaries, the value is none.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "DeviceDetail",
              "type": "string",
              "displayName": "DeviceDetail",
              "description": "Details of the device used for the sign-in.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "HomeTenantId",
              "type": "string",
              "displayName": "HomeTenantId",
              "description": "The home tenant ID for cross-tenant scenarios.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "Id",
              "type": "string",
              "displayName": "Id",
              "description": "Unique ID representing the sign-in activity.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "IPAddress",
              "type": "string",
              "displayName": "IPAddress",
              "description": "IP address of the client used to sign in.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "IsInteractive",
              "type": "boolean",
              "displayName": "IsInteractive",
              "description": "Indicates if a sign-in is interactive or not.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "IsRisky",
              "type": "boolean",
              "displayName": "IsRisky",
              "description": "Indicates if a sign-in is considered risky or not.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "LocationDetails",
              "type": "string",
              "displayName": "LocationDetails",
              "description": "Details of the sign-in location.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "MfaDetail",
              "type": "string",
              "displayName": "MfaDetail",
              "description": "Details of the Multi-factor authentication.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "NetworkLocationDetails",
              "type": "string",
              "displayName": "NetworkLocationDetails",
              "description": "Provides the details associated with authentication processor.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "OriginalRequestId",
              "type": "string",
              "displayName": "OriginalRequestId",
              "description": "The request id of the first request in the authentication sequence.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "ProcessingTimeInMs",
              "type": "string",
              "displayName": "ProcessingTimeInMs",
              "description": "Request processing time in milliseconds in AD STS.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "ResourceDisplayName",
              "type": "string",
              "displayName": "ResourceDisplayName",
              "description": "Name of the resource that the user signed into.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "ResourceIdentity",
              "type": "string",
              "displayName": "ResourceIdentity",
              "description": "ID of the resource that the user signed into.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "ResourceServicePrincipalId",
              "type": "string",
              "displayName": "ResourceServicePrincipalId",
              "description": "Service Principal Id of the resource.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "ResourceTenantId",
              "type": "string",
              "displayName": "ResourceTenantId",
              "description": "The resource tenant ID for cross-tenant scenarios.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "RiskDetail",
              "type": "string",
              "displayName": "RiskDetail",
              "description": "Risky user state details.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "RiskEventTypes",
              "type": "string",
              "displayName": "RiskEventTypes",
              "description": "The list of risk event types associated with the sign-in.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "RiskEventTypes_V2",
              "type": "string",
              "displayName": "RiskEventTypes_V2",
              "description": "The list of risk event types associated with the sign-in. These are strings.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "RiskLevelAggregated",
              "type": "string",
              "displayName": "RiskLevelAggregated",
              "description": "Aggregated risk level.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "RiskLevelDuringSignIn",
              "type": "string",
              "displayName": "RiskLevelDuringSignIn",
              "description": "Risk level during sign-in.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "RiskState",
              "type": "string",
              "displayName": "RiskState",
              "description": "Risky user state.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "ServicePrincipalId",
              "type": "string",
              "displayName": "ServicePrincipalId",
              "description": "ID of the service principal who initiated the sign-in.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "SessionLifetimePolicies",
              "type": "string",
              "displayName": "SessionLifetimePolicies",
              "description": "Policies and settings that applied to the sign-in that enforced or revoked a session lifetime.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "SignInEventTypes",
              "type": "string",
              "displayName": "SignInEventTypes",
              "description": "The types that are associated with the sign-in.  Examples include \"interactive\", \"refreshToken\", \"managedIdentity\", \"continuousAccessEvaluation\" and many more.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "SignInIdentifierType",
              "type": "string",
              "displayName": "SignInIdentifierType",
              "description": "The type of sign in identifier. Possible values are: userPrincipalName, phoneNumber, proxyAddress, qrCode, onPremisesUserPrincipalName, unknownFutureValue.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "Status",
              "type": "string",
              "displayName": "Status",
              "description": "Details of the sign-in status.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "TokenIssuerName",
              "type": "string",
              "displayName": "TokenIssuerName",
              "description": "Name of the identity provider (e.g. sts.microsoft.com ).",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "TokenIssuerType",
              "type": "string",
              "displayName": "TokenIssuerType",
              "description": "Type of identityProvider (Azure AD, AD Federation Services).",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "UniqueTokenIdentifier",
              "type": "string",
              "displayName": "UniqueTokenIdentifier",
              "description": "Unique token identifier for the request.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "UserAgent",
              "type": "string",
              "displayName": "UserAgent",
              "description": "User Agent for the sign-in.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "UserDisplayName",
              "type": "string",
              "displayName": "UserDisplayName",
              "description": "Display name of the user that initiated the sign-in.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "UserId",
              "type": "string",
              "displayName": "UserId",
              "description": "ID of the user that initiated the sign-in.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "UserPrincipalName",
              "type": "string",
              "displayName": "UserPrincipalName",
              "description": "User principal name of the user that initiated the sign-in.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "UserType",
              "type": "string",
              "displayName": "UserType",
              "description": "Identifies whether the user is a member or guest in the tenant. Possible values are: member, guest, unknownFutureValue.",
              "isDefaultDisplay": true,
              "isHidden": false
            }
          ]
        },
        "plan": "Basic",
        "totalRetentionInDays": 180,
        "name": "AADNonInteractiveUserSignInLogs_CL"
      },
      "name": "[concat(parameters('workspaceName'), '/AADNonInteractiveUserSignInLogs_CL')]"
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/tables",
      "apiVersion": "2022-10-01",
      "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspaceName')), '/tables/StorageBlobLogs')]",
      "properties": {
        "plan": "Analytics",
        "retentionInDays": 60
      },
      "name": "[concat(parameters('workspaceName'), '/StorageBlobLogs')]"
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/tables",
      "apiVersion": "2021-12-01-preview",
      "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspaceName')), '/tables/StorageBlobLogs_CL')]",
      "properties": {
        "schema": {
          "name": "StorageBlobLogs_CL",
          "columns": [
            {
              "name": "TimeGenerated",
              "type": "datetime",
              "displayName": "TimeGenerated",
              "description": "The Universal Time Coordinated (UTC) time when the request was received by storage.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "AccountName",
              "type": "string",
              "displayName": "AccountName",
              "description": "The name of the storage account.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "Location",
              "type": "string",
              "displayName": "Location",
              "description": "The location of storage account.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "Protocol",
              "type": "string",
              "displayName": "Protocol",
              "description": "The protocol that is used in the operation.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "OperationName",
              "type": "string",
              "displayName": "OperationName",
              "description": "The type of REST operation that was performed.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "AuthenticationType",
              "type": "string",
              "displayName": "AuthenticationType",
              "description": "The type of authentication that was used to make the request.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "StatusCode",
              "type": "string",
              "displayName": "StatusCode",
              "description": "The HTTP status code for the request. If the request is interrupted, this value might be set to Unknown.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "StatusText",
              "type": "string",
              "displayName": "StatusText",
              "description": "The status of the requested operation.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "DurationMs",
              "type": "real",
              "displayName": "DurationMs",
              "description": "The total time, expressed in milliseconds, to perform the requested operation. This includes the time to read the incoming request, and to send the response to the requester.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "ServerLatencyMs",
              "type": "real",
              "displayName": "ServerLatencyMs",
              "description": "The total time expressed in milliseconds to perform the requested operation. This value doesn't include network latency (the time to read the incoming request and send the response to the requester).",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "Uri",
              "type": "string",
              "displayName": "Uri",
              "description": "Uniform resource identifier that is requested.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "CallerIpAddress",
              "type": "string",
              "displayName": "CallerIpAddress",
              "description": "The IP address of the requester, including the port number.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "CorrelationId",
              "type": "string",
              "displayName": "CorrelationId",
              "description": "The ID that is used to correlate logs across resources.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "SchemaVersion",
              "type": "string",
              "displayName": "SchemaVersion",
              "description": "The schema version of the log.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "OperationVersion",
              "type": "string",
              "displayName": "OperationVersion",
              "description": "The storage service version that was specified when the request was made. This is equivalent to the value of the x-ms-version header.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "AuthenticationHash",
              "type": "string",
              "displayName": "AuthenticationHash",
              "description": "The hash of authentication token.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "RequesterObjectId",
              "type": "string",
              "displayName": "RequesterObjectId",
              "description": "The OAuth object ID of the requester.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "RequesterTenantId",
              "type": "string",
              "displayName": "RequesterTenantId",
              "description": "The OAuth tenant ID of identity.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "RequesterAppId",
              "type": "string",
              "displayName": "RequesterAppId",
              "description": "The Open Authorization (OAuth) application ID that is used as the requester.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "RequesterAudience",
              "type": "string",
              "displayName": "RequesterAudience",
              "description": "The OAuth audience of the request.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "RequesterTokenIssuer",
              "type": "string",
              "displayName": "RequesterTokenIssuer",
              "description": "The OAuth token issuer.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "RequesterUpn",
              "type": "string",
              "displayName": "RequesterUpn",
              "description": "The User Principal Names of requestor.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "AuthorizationDetails",
              "type": "dynamic",
              "displayName": "AuthorizationDetails",
              "description": "Detailed policy information used to authorize the request.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "UserAgentHeader",
              "type": "string",
              "displayName": "UserAgentHeader",
              "description": "The User-Agent header value, in quotes.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "ReferrerHeader",
              "type": "string",
              "displayName": "ReferrerHeader",
              "description": "The Referer header value.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "ClientRequestId",
              "type": "string",
              "displayName": "ClientRequestId",
              "description": "The x-ms-client-request-id header value of the request.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "Etag",
              "type": "string",
              "displayName": "Etag",
              "description": "The ETag identifier for the returned object, in quotes.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "ServiceType",
              "type": "string",
              "displayName": "ServiceType",
              "description": "The service associated with this request.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "OperationCount",
              "type": "int",
              "displayName": "OperationCount",
              "description": "The number of each logged operation that is involved in the request. This count starts with an index of 0. Some requests require more than one operation, such as a request to copy a blob. Most requests perform only one operation.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "ObjectKey",
              "type": "string",
              "displayName": "ObjectKey",
              "description": "The key of the requested object, in quotes.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "RequestHeaderSize",
              "type": "long",
              "displayName": "RequestHeaderSize",
              "description": "The size of the request header expressed in bytes. If a request is unsuccessful, this value might be empty.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "RequestBodySize",
              "type": "long",
              "displayName": "RequestBodySize",
              "description": "The size of the request packets, expressed in bytes, that are read by the storage service. If a request is unsuccessful, this value might be empty.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "ResponseHeaderSize",
              "type": "long",
              "displayName": "ResponseHeaderSize",
              "description": "The size of the response header expressed in bytes. If a request is unsuccessful, this value might be empty.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "ResponseBodySize",
              "type": "long",
              "displayName": "ResponseBodySize",
              "description": "The size of the response packets written by the storage service, in bytes. If a request is unsuccessful, this value may be empty.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "RequestMd5",
              "type": "string",
              "displayName": "RequestMd5",
              "description": "The value of either the Content-MD5 header or the x-ms-content-md5 header in the request. The MD5 hash value specified in this field represents the content in the request.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "ResponseMd5",
              "type": "string",
              "displayName": "ResponseMd5",
              "description": "The value of the MD5 hash calculated by the storage service.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "LastModifiedTime",
              "type": "datetime",
              "displayName": "LastModifiedTime",
              "description": "The Last Modified Time (LMT) for the returned object. This field is empty for operations that can return multiple objects.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "ConditionsUsed",
              "type": "string",
              "displayName": "ConditionsUsed",
              "description": "A semicolon-separated list of key-value pairs that represent a condition.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "ContentLengthHeader",
              "type": "long",
              "displayName": "ContentLengthHeader",
              "description": "The value of the Content-Length header for the request sent to the storage service.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "Category",
              "type": "string",
              "displayName": "Category",
              "description": "The category of requested operation.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "TlsVersion",
              "type": "string",
              "displayName": "TlsVersion",
              "description": "The TLS version used in the connection of request.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "SasExpiryStatus",
              "type": "string",
              "displayName": "SasExpiryStatus",
              "description": "Records any violations in the request SAS token as per the SAS policy set in the storage account. Ex: longer SAS token duration specified than allowed per SAS policy",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "MetricResponseType",
              "type": "string",
              "displayName": "MetricResponseType",
              "description": "Records the metric response for correlation between metrics and logs.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "SourceUri",
              "type": "string",
              "displayName": "SourceUri",
              "description": "Records the source URI for operations.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "DestinationUri",
              "type": "string",
              "displayName": "DestinationUri",
              "description": "Records the destination URI for operations.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "AccessTier",
              "type": "string",
              "displayName": "AccessTier",
              "description": "The access tier of the storage account.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "SourceAccessTier",
              "type": "string",
              "displayName": "SourceAccessTier",
              "description": "The source tier of the storage account.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "RehydratePriority",
              "type": "string",
              "displayName": "RehydratePriority",
              "description": "The priority used to rehydrate an archived blob.",
              "isDefaultDisplay": true,
              "isHidden": false
            },
            {
              "name": "SourceSystem",
              "type": "string",
              "displayName": "SourceSystem",
              "isDefaultDisplay": true,
              "isHidden": false
            }
          ]
        },
        "plan": "Basic",
        "totalRetentionInDays": 180,
        "name": "StorageBlobLogs_CL"
      },
      "name": "[concat(parameters('workspaceName'), '/StorageBlobLogs_CL')]"
    }
  ],
  "parameters": {
    "dcrName": {
      "defaultValue": "dcr-law-sentinel-01",
      "type": "string"
    },
    "workspaceName": {
      "defaultValue": "law-sentinel-01",
      "type": "string"
    }
  }
}
